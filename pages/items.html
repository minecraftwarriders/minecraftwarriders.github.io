<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Server Shop</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .controls {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 12px 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .search-box:focus {
            outline: none;
            border-color: #667eea;
        }

        .section-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .section-btn {
            padding: 10px 20px;
            background: #f0f0f0;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95em;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .section-btn:hover {
            background: #e0e0e0;
        }

        .section-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .page-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .page-btn {
            padding: 8px 15px;
            background: #f0f0f0;
            border: 2px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .page-btn:hover {
            background: #e0e0e0;
        }

        .page-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .page-info {
            font-size: 0.9em;
            color: #666;
        }

        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .item-card {
            background: #f9f9f9;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .item-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            border-color: #667eea;
        }

        .item-image {
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 12px;
            background: #f0f0f0;
            border-radius: 8px;
            overflow: hidden;
        }

        .item-image img {
            max-height: 100%;
            max-width: 100%;
            object-fit: contain;
        }

        .item-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            font-size: 0.95em;
            word-wrap: break-word;
        }

        .item-prices {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .price {
            font-size: 0.85em;
            padding: 6px 8px;
            border-radius: 6px;
            font-weight: 500;
        }

        .buy-price {
            background: #e3f2fd;
            color: #1976d2;
        }

        .sell-price {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .no-items {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 1.1em;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #667eea;
            font-size: 1.1em;
        }

        .error {
            text-align: center;
            padding: 20px;
            color: #d32f2f;
            font-size: 1em;
            background: #ffebee;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Shop</h1>

        <div class="controls">
            <input type="text" class="search-box" id="searchInput" placeholder="Search items...">
        </div>

        <div class="section-tabs" id="sectionTabs"></div>

        <div class="page-controls" id="pageControls"></div>

        <div class="items-grid" id="itemsGrid"></div>
    </div>

    <script>
        const sections = [
            'Automation', 'Blocks', 'Decoration', 'Dyes', 'Enchanting', 'Farming',
            'Food', 'Miscellaneous', 'Mobs', 'Music', 'Ores', 'Potions',
            'Redstone', 'SpawnEggs', 'Spawners', 'Workstations', 'Z_EverythingElse'
        ];

        let allData = {};
        let currentSection = sections[0];
        let currentPage = 'page1';
        let searchQuery = '';

        const searchInput = document.getElementById('searchInput');
        const sectionTabs = document.getElementById('sectionTabs');
        const pageControls = document.getElementById('pageControls');
        const itemsGrid = document.getElementById('itemsGrid');

        // Load all YAML files
        async function loadAllSections() {
            try {
                itemsGrid.innerHTML = '<div class="loading">Loading shop data...</div>';
                console.log('Starting to load sections...');

                for (const section of sections) {
                    try {
                        const path = `sections/${section}.yml`;
                        console.log(`Fetching: ${path}`);
                        
                        const response = await fetch(path);
                        console.log(`${section}.yml - Status: ${response.status}`);
                        
                        if (!response.ok) throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                        
                        const text = await response.text();
                        console.log(`${section}.yml - Loaded successfully, ${text.length} bytes`);
                        
                        const data = jsYaml.load(text);
                        allData[section] = data.pages || {};
                    } catch (error) {
                        console.error(`Error loading ${section}:`, error);
                        allData[section] = {};
                    }
                }

                console.log('All sections loaded. Data:', allData);
                initializePage();
            } catch (error) {
                itemsGrid.innerHTML = `<div class="error">Error loading shop data. Check console for details.</div>`;
                console.error('Fatal error:', error);
            }
        }

        function initializePage() {
            renderSectionTabs();
            updatePageControls();
            renderItems();
        }

        function renderSectionTabs() {
            sectionTabs.innerHTML = '';
            sections.forEach(section => {
                const btn = document.createElement('button');
                btn.className = `section-btn ${section === currentSection ? 'active' : ''}`;
                btn.textContent = section;
                btn.onclick = () => {
                    currentSection = section;
                    currentPage = 'page1';
                    searchQuery = '';
                    searchInput.value = '';
                    renderSectionTabs();
                    updatePageControls();
                    renderItems();
                };
                sectionTabs.appendChild(btn);
            });
        }

        function updatePageControls() {
            pageControls.innerHTML = '';
            const pages = Object.keys(allData[currentSection] || {}).sort();

            if (pages.length === 0) {
                pageControls.innerHTML = '<div class="page-info">No pages available</div>';
                return;
            }

            const pageLabel = document.createElement('div');
            pageLabel.className = 'page-info';
            pageLabel.textContent = 'Pages:';
            pageControls.appendChild(pageLabel);

            pages.forEach(page => {
                const btn = document.createElement('button');
                btn.className = `page-btn ${page === currentPage ? 'active' : ''}`;
                btn.textContent = page;
                btn.onclick = () => {
                    currentPage = page;
                    searchQuery = '';
                    searchInput.value = '';
                    updatePageControls();
                    renderItems();
                };
                pageControls.appendChild(btn);
            });
        }

        function getItemImage(material) {
            const formatted = material.toLowerCase().replace(/_/g, ' ');
            return `https://minecraft.wiki/images/Invicon_${material}.png`;
        }

        function renderItems() {
            itemsGrid.innerHTML = '';

            const sectionData = allData[currentSection] || {};
            const pageData = sectionData[currentPage] || { items: {} };
            let items = pageData.items || {};

            if (searchQuery.trim()) {
                const query = searchQuery.toLowerCase();
                items = Object.fromEntries(
                    Object.entries(items).filter(([_, item]) =>
                        item.material.toLowerCase().includes(query)
                    )
                );
            }

            if (Object.keys(items).length === 0) {
                itemsGrid.innerHTML = '<div class="no-items">No items found</div>';
                return;
            }

            Object.entries(items).forEach(([slot, item]) => {
                const card = document.createElement('div');
                card.className = 'item-card';

                const imageName = item.material.charAt(0).toUpperCase() + item.material.slice(1).toLowerCase();
                const imageUrl = getItemImage(item.material);

                card.innerHTML = `
                    <div class="item-image">
                        <img src="${imageUrl}" alt="${item.material}" onerror="this.style.display='none'">
                    </div>
                    <div class="item-name">${item.material}</div>
                    <div class="item-prices">
                        <div class="price buy-price">Buy: ${item.buy.toFixed(2)}</div>
                        <div class="price sell-price">Sell: ${item.sell.toFixed(2)}</div>
                    </div>
                `;

                itemsGrid.appendChild(card);
            });
        }

        searchInput.addEventListener('input', (e) => {
            searchQuery = e.target.value;
            renderItems();
        });

    <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
